var vm={};
vm.update=false;
window.vmLabels=[];
window.lastClickedElement={};
window.lastSubmittedFormId="";
var setLastVars=function(a){a=a||event;
window.lastClickedElement=a.target||a.srcElement;
window.lastSubmittedFormId=$(lastClickedElement).closest("form").attr("id")
};
window.submitInProgress=false;
window.activateSpinnerVM=function(a,b){if(b===true&&window.submitInProgress===true){return false
}if(typeof a==="undefined"||a==null){return true
}var c=a.target||a.srcElement;
var d={};
if(typeof c!=="undefined"){d=$(c)
}else{return true
}if(b===true){window.submitInProgress=true;
d.addClass("loadingLink disabled")
}else{window.submitInProgress=false;
d.removeClass("loadingLink disabled");
$("[type=password]:not(.persist-password)").val("")
}};
var processMessageVM=function(g,b){if(g==null||$.isEmptyObject(g)||g.length==0){return g
}if(g.messageSeverity==null||g.messageSeverity.length==0){g.messageSeverity="error"
}if(g.messageScope==null||g.messageScope.length==0||g.messageScope.toUpperCase()!="FIELD"){g.messageScope="GLOBAL"
}else{g.messageScope="FIELD"
}if(g.messageScope=="FIELD"&&(g.fieldName==null||g.fieldName.length==0)){g.messageScope="GLOBAL"
}if(g.messageScope=="FIELD"){var a="[name^='"+g.fieldName+"']";
if(window.lastSubmittedFormId!=null&&window.lastSubmittedFormId.length>0){a="#"+window.lastSubmittedFormId+" "+a
}var f=$(a);
if(f.length==0){g.messageScope="GLOBAL"
}}if(g.code!=null&&g.code.length>0&&b!=null&&$.isEmptyObject(b)==false){var c=g.code;
if(g.messageScope=="FIELD"&&b!=null){var d=g.fieldName+"_"+c;
if(b[d]!=null&&b[d].length>0){g.message=b[d];
return g
}}if(b!=null&&b[c]!=null&&b[c].length>0){g.message=b[c];
return g
}}if(g.message!=null&&g.message.length>0){return g
}var e=(g.messageScope=="FIELD")?"field_error":"global_error";
if(b!=null&&b[e]!=null&&b[e].length>0){g.message=b[e]
}else{g.message=null
}return g
};
var processAllMessagesVM=function(g,d,f){if(d.messageList==null||d.messageList==false||d.messageList.length==0){return d.messageList
}$("body").trigger("analyticsMessageListData",[{messageList:d.messageList}]);
for(var b=0,a=d.messageList.length;
b<a;
b++){d.messageList[b]=processMessageVM(d.messageList[b],f.labels)
}var c=0;
var e=0;
for(i=d.messageList.length-1;
i>=0;
i--){if(d.messageList[i]["message"]==null||d.messageList[i]["message"].length==0){d.messageList.splice(i,1)
}else{if(d.messageList[i]["messageScope"]=="FIELD"){c++
}else{if(d.messageList[i]["messageScope"]=="GLOBAL"){e++
}}}}if(c>0||e>0){$(".pleaseStandBy, #pleaseStandBy").hide();
$("div#tiles, div.header, div.top-alert").show()
}if(e>0&&c==0){$("html").scrollTop(0)
}if(g!=null&&g.type!=null&&g.type=="POST"){removeGlobalMessages()
}collectGlobalMessages(d.messageList);
return d.messageList
};
var ViewModel=function(e,b,a,d){if(!a){return
}var f=this;
var c=(a)?document.getElementById(a):"";
if(c===null){return
}$("#"+a).addClass("loading");
secureToken2Promise.then(function(){if(e===false){$("#"+a).removeClass("loading").show();
ko.applyBindings(new Handler(false,d,b),c);
$("body").trigger("applyBindings")
}else{$.ajax({url:e,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"get",error:function(){handleAjaxErrors(e,"GET",d);
$(document).trigger("ajaxGetComplete",[a])
},success:function(g){if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof b==="function"){aReady(aProcessHooks(g,_hooks,"GET",getComponentName(b)))
}if(d.form&&d.form.formId){createHiddenFields(g,"#"+d.form.formId)
}$("#"+a).removeClass("loading");
vmLabels.push(d.labels);
g.messageList=processAllMessagesVM(this,g,d);
switch(vm.update){case true:new Handler(g,d,b);
break;
default:ko.applyBindings(new Handler(g,d,b),c)
}$("body").trigger("applyBindings");
$(document).trigger("ajaxGetComplete",[a])
}})
}}).done(function(){})
};
function handleAjaxErrors(a,c,d){if(typeof d.error==="undefined"){d.error=handleAjaxErrors.defaultErrorHandlers
}else{for(var b in handleAjaxErrors.defaultErrorHandlers){if(typeof b!=="undefined"&&typeof d.error[b]==="undefined"){d.error[b]=handleAjaxErrors.defaultErrorHandlers[b]
}}}if(c==="GET"){if(typeof d.error.AJAX_GET==="function"){d.error.AJAX_GET(a,c,d)
}else{if(d.error.AJAX_GET!==null){window.location=d.error.AJAX_GET
}}}if(c==="POST"){if(typeof d.error.AJAX_POST==="function"){d.error.AJAX_POST(a,c,d)
}else{if(d.error.AJAX_POST!==null){window.location=d.error.AJAX_POST
}}}if(typeof d.error.AJAX_ERROR==="function"){d.error.AJAX_ERROR(a,c,d)
}else{if(d.error.AJAX_ERROR!==null){window.location=d.error.AJAX_ERROR
}}}handleAjaxErrors.defaultErrorHandlers={AJAX_GET:null,AJAX_POST:null,AJAX_ERROR:null};
function collectGlobalMessages(d){var b="";
for(var a in d){if(d[a].messageScope=="GLOBAL"){globalMessagesKO.messages.push(d[a])
}if(d[a].messageScope=="FIELD"){if($("input[name='"+d[a].fieldName+"']").attr("type")=="hidden"){d[a].messageScope="GLOBAL";
globalMessagesKO.messages.push(d[a])
}else{$("[name='"+d[a].fieldName+"']").attr({"aria-invalid":"true","aria-describedby":d[a].fieldName+"_error"});
if(b===""){b=d[a];
var c=$("[name='"+b.fieldName+"']");
if(c.prev("label").offset()){$("html, body").scrollTop(c.prev("label").offset().top)
}setTimeout(function(){c.trigger("focus")
},2500)
}}}}if(d.length>0){$("div#modal div.content section").scrollTop(0)
}}function removeGlobalMessages(){window.globalMessagesKO.messages.removeAll()
}var GlobalMessagesModel=function(){var a=document.getElementById("top");
var b=new GlobalMessagesHandler();
if(a){ko.applyBindings(b,a);
return b
}return undefined
};
var GlobalMessagesHandler=function(){this.messages=ko.observableArray();
this.pushMessage=function(a){this.messages.push(a)
};
this.unshiftMessage=function(a){this.messages.unshift(a)
}
};
function substituteMessageTranslations(d,e){var c=[];
for(name in e){c.push(name)
}for(var a in d){var b="";
if(d[a].messageScope=="FIELD"){b=d[a].fieldName+"_"+d[a].code
}else{b=d[a].code
}if($.inArray(b,c)>-1){d[a].message=e[b]
}}}function getFormData(b,d){var a=[];
var c="";
if(typeof b.submitFormIds!="undefined"){$.each(b.submitFormIds,function(e,f){a.push("#"+f)
});
c=a.toString()
}else{c+="#"+d
}return $(c).serialize()
}function clearARIA(a){if(a){$("#"+a+" input, #"+a+" select").removeAttr("aria-describedby aria-invalid")
}}var Handler=function(b,c,a){var e=this;
var d="";
a.handler=this;
if(c.form&&c.form.formId){$("#"+c.form.formId).keypress(function(f){if(f.which===13){if(f.target.tagName.toUpperCase()!=="A"&&f.target.tagName.toUpperCase()!=="SELECT"&&(!$(f.target).hasClass("dt"))&&(!$(f.target).hasClass("modal"))&&(!$(f.target).hasClass("paymentType"))&&(!$(f.target).hasClass("autocomplete"))){$(this).find('[data-bind*="click: $root.submitForm"]').click();
return false
}}})
}e.messages=ko.observable(b.messageList);
e.hideShow=ko.observable(b.hideShow);
e.labels=ko.observable(c.labels);
e.redirect=function(f,g){if(!f.redirect){return false
}$.each(f.redirect,function(h,k){if(h==="forward"){for(j in g){if(k===j){d=g[j]
}}}if(h==="suffix"&&null!=k){d=d+"/"+k
}});
if(d.length>0){if(typeof aReady==="function"){aReady(function(){window.location=d
},false,250)
}else{window.location=d
}}};
e.updateMessages=function(f){e.messages(f)
};
e.submitForm=function(){var k;
var h;
if(arguments.length==1){if(typeof arguments[0].target!="undefined"){h=arguments[0]
}else{k=arguments[0]
}}else{if(arguments.length>1){if(typeof arguments[0].target!="undefined"){h=arguments[0];
k=arguments[1]
}else{if(typeof arguments[1].target!="undefined"){h=arguments[1];
k=arguments[0]
}}}}try{var f,n,m;
var g=h.currentTarget.getAttribute("data-submit");
$.each(c.form,function(o,p){if(o==g){f=o
}});
n=c.form[f].url;
m=c.form[f].formId
}catch(l){n=c.form.url;
m=c.form.formId
}clearARIA(m);
$.ajax({url:n,contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"post",data:getFormData(c,m),beforeSend:function(){if(activateSpinnerVM(h,true)===false){return false
}},complete:function(p,q){var o=$.parseJSON(p.responseText);
if(q!=="success"||(typeof o.messageList!=="undefined"&&(typeof o.messageList.length==="undefined"||o.messageList.length>0))){activateSpinnerVM(h,false)
}},error:function(){if(typeof c.form!=="undefined"&&typeof c.form.error==="function"){c.form.error(c)
}handleAjaxErrors(n,"POST",c)
},success:function(o){o.messageList=processAllMessagesVM(this,o,c);
e.messages(o.messageList);
if(typeof c.form!=="undefined"&&typeof c.form.success==="function"){c.form.success(o)
}if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof a==="function"){aReady(aProcessHooks(o,_hooks,"POST",getComponentName(a)))
}e.redirect(o,c.forwards)
}});
return false
};
this.submitFormAndPost=function(){var k;
var h;
if(arguments.length==1){if(typeof arguments[0].target!="undefined"){h=arguments[0]
}else{k=arguments[0]
}}else{if(arguments.length>1){if(typeof arguments[0].target!="undefined"){h=arguments[0];
k=arguments[1]
}else{if(typeof arguments[1].target!="undefined"){h=arguments[1];
k=arguments[0]
}}}}try{var f,n,m;
var g=h.currentTarget.getAttribute("data-submit");
$.each(c.form,function(o,p){if(o==g){f=o
}});
n=c.form[f].url;
m=c.form[f].formId
}catch(l){n=c.form.url;
m=c.form.formId
}$.ajax({url:n,contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"post",data:getFormData(c,m),beforeSend:function(){if(activateSpinnerVM(h,true)===false){return false
}},complete:function(p,q){var o=$.parseJSON(p.responseText);
if(q!=="success"||(typeof o.messageList!=="undefined"&&(typeof o.messageList.length==="undefined"||o.messageList.length>0))){activateSpinnerVM(h,false)
}},error:function(){handleAjaxErrors(c.form.url,"POST",c)
},success:function(o){if(typeof c.success==="function"){c.success(o)
}if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof a==="function"){aReady(aProcessHooks(o,_hooks,"POST",getComponentName(a)))
}o.messageList=processAllMessagesVM(this,o,c);
e.messages(o.messageList);
e.redirect(o,c.forwards);
if(a!==false){a(o,c.forwards)
}}});
return false
};
e.redirect(b,c.forwards);
if(a!==false){a(b,c.forwards)
}};
$(function(){if(typeof window.globalMessagesKO==="undefined"){window.globalMessagesKO=new GlobalMessagesModel()
}$("a, button, input[type='submit']").live("click",setLastVars)
});
var ViewModelOCI=function(f,c,a,e){if(!a){return
}var b;
var g=this;
var d=(a)?document.getElementById(a):"";
if(d===null){return
}$("#"+a).addClass("loading");
secureToken2Promise.then(function(){if(f===false){b=new HandlerOCI(false,e,c);
ko.applyBindings(b,d);
$("body").trigger("applyBindings");
return b
}else{$.ajax({url:f,dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"get",error:function(){handleAjaxErrors(f,"GET",e)
},success:function(h){if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof c==="function"){aReady(aProcessHooks(h,_hooks,"GET",getComponentName(c)))
}if(e.form&&e.form.formId){createHiddenFields(h,"#"+e.form.formId)
}$("#"+a).removeClass("loading");
vmLabels.push(e.labels);
h.messageList=processAllMessagesVM(this,h,e);
b=new HandlerOCI(h,e,c);
ko.applyBindings(b,d);
$("body").trigger("applyBindings");
if(c===driverInformation){driverInformationHandler=b
}else{if(c===AirlineInfo){airlineInfoHandler=b
}else{if(c===frequentTravellerInfo){frequentTravellerInfoHandler=b
}else{if(c===detailContainer){detailContainerHandler=b
}else{if(typeof(alamo.oci.addonContainer)!=="undefined"&&c===alamo.oci.addonContainer){addonContainerHandler=b
}else{if(typeof(alamo.oci.PaymentInfoViewModel)!=="undefined"&&c===alamo.oci.PaymentInfoViewModel){paymentInfoHandler=b
}else{if(typeof(additionalDriverInformation)!=="undefined"&&c===additionalDriverInformation){additionalDriverInformationHandler=b
}}}}}}}$(document).trigger("ajaxGetComplete")
}})
}})
};
var HandlerOCI=function(b,c,a){var e=this;
var d="";
$("#left").unbind("keypress").keypress(function(f){if(f.which===13){if(f.target.tagName.toUpperCase()!=="A"&&f.target.tagName.toUpperCase()!=="SELECT"&&(!$(f.target).hasClass("dt"))&&(!$(f.target).hasClass("autocomplete"))){$(this).find('[data-bind*="click: $root.submitForm"]').click();
return false
}}});
e.messages=ko.observable(b.messageList);
e.hideShow=ko.observable(b.hideShow);
e.labels=ko.observable(c.labels);
e.redirect=function(f,g){if(!f.redirect){return false
}$.each(f.redirect,function(h,k){if(h==="forward"){for(j in g){if(k===j){d=g[j]
}}}if(h==="suffix"&&null!=k){d=d+"/"+k
}});
if(d.length>0){if(typeof aReady==="function"){aReady(function(){window.location=d
},false,250)
}else{window.location=d
}}};
e.submitForm=function(){var k;
var h;
if(arguments.length==1){if(typeof arguments[0].target!="undefined"){h=arguments[0]
}else{k=arguments[0]
}}else{if(arguments.length>1){if(typeof arguments[0].target!="undefined"){h=arguments[0];
k=arguments[1]
}else{if(typeof arguments[1].target!="undefined"){h=arguments[1];
k=arguments[0]
}}}}try{var f,n,m;
var g=h.currentTarget.getAttribute("data-submit");
$.each(c.form,function(o,p){if(o==g){f=o
}});
n=c.form[f].url;
m=c.form[f].formId
}catch(l){n=c.form.url;
m=c.form.formId
}$.ajax({url:n,contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"post",data:getFormData(c,m),beforeSend:function(){if(activateSpinnerVM(h,true)===false){return false
}},complete:function(p,q){var o=$.parseJSON(p.responseText);
if(q!=="success"||(typeof o.messageList!=="undefined"&&(typeof o.messageList.length==="undefined"||o.messageList.length>0))){activateSpinnerVM(h,false)
}},error:function(){if(typeof c.form!=="undefined"&&typeof c.form.error==="function"){c.form.error(c)
}handleAjaxErrors(n,"POST",c)
},success:function(r){if(typeof c.form!=="undefined"&&typeof c.form.success==="function"){c.form.success(r)
}if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof a==="function"){aReady(aProcessHooks(r,_hooks,"POST",getComponentName(a)))
}r.messageList=processAllMessagesVM(this,r,c);
e.messages(r.messageList);
e.redirect(r,c.forwards);
if(typeof(additionalDriverInformationHandler)!=="undefined"&&e===additionalDriverInformationHandler){if(r.doNotRent){var q=$("#modal div.content");
$.ajax({url:doNotRentForwardUrl,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"html",error:function(){},success:function(s){q.empty();
q.append(s)
},error:function(){top.append('<p role="alert" class="error">'+e.labels.generic_global_error+"</p>");
top.css("position","relative")
}});
window.submitInProgress=false;
return false
}}var p=[];
if(typeof(addonContainerHandler)!=="undefined"){p.push(addonContainerHandler)
}if(typeof(detailContainerHandler)!=="undefined"){p.push(detailContainerHandler)
}if(typeof(driverInformationHandler)!=="undefined"){p.push(driverInformationHandler)
}if(typeof(airlineInfoHandler)!=="undefined"){p.push(airlineInfoHandler)
}if(typeof(frequentTravellerInfoHandler)!=="undefined"){p.push(frequentTravellerInfoHandler)
}if(typeof(paymentInfoHandler)!=="undefined"){p.push(paymentInfoHandler)
}for(var o=0;
o<p.length;
o++){if(p[o]!==undefined&&p[o].messages!==undefined){p[o].messages(r.messageList)
}}}});
return false
};
this.submitFormAndPost=function(){var k;
var h;
if(arguments.length==1){if(typeof arguments[0].target!="undefined"){h=arguments[0]
}else{k=arguments[0]
}}else{if(arguments.length>1){if(typeof arguments[0].target!="undefined"){h=arguments[0];
k=arguments[1]
}else{if(typeof arguments[1].target!="undefined"){h=arguments[1];
k=arguments[0]
}}}}try{var f,n,m;
var g=h.currentTarget.getAttribute("data-submit");
$.each(c.form,function(o,p){if(o==g){f=o
}});
n=c.form[f].url;
m=c.form[f].formId
}catch(l){n=c.form.url;
m=c.form.formId
}$.ajax({url:c.form.url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",type:"post",data:getFormData(c,m),beforeSend:function(){if(activateSpinnerVM(h,true)===false){return false
}},complete:function(p,q){var o=$.parseJSON(p.responseText);
if(q!=="success"||(typeof o.messageList!=="undefined"&&(typeof o.messageList.length==="undefined"||o.messageList.length>0))){activateSpinnerVM(h,false)
}},error:function(){handleAjaxErrors(c.form.url,"POST",c)
},success:function(q){if(typeof c.success==="function"){c.success(q)
}if(typeof _hooks!=="undefined"&&typeof aProcessHooks!=="undefined"&&typeof a==="function"){aReady(aProcessHooks(q,_hooks,"POST",getComponentName(a)))
}q.messageList=processAllMessagesVM(this,q,c);
e.messages(q.messageList);
e.redirect(q,c.forwards);
var p=[];
if(typeof(addonContainerHandler)!=="undefined"){p.push(addonContainerHandler)
}if(typeof(detailContainerHandler)!=="undefined"){p.push(detailContainerHandler)
}if(typeof(driverInformationHandler)!=="undefined"){p.push(driverInformationHandler)
}if(typeof(airlineInfoHandler)!=="undefined"){p.push(airlineInfoHandler)
}if(typeof(frequentTravellerInfoHandler)!=="undefined"){p.push(frequentTravellerInfoHandler)
}if(typeof(paymentInfoHandler)!=="undefined"){p.push(paymentInfoHandler)
}for(var o=0;
o<p.length;
o++){if(p[o]!==undefined&&p[o].messages!==undefined){p[o].messages(q.messageList)
}}if(a!==false){a(q,c.forwards)
}}});
return false
};
e.redirect(b,c.forwards);
if(a!==false){a(b,c.forwards)
}};